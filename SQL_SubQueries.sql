create table Salesman(
salesman_id int,
name varchar(100),
city varchar(100),
commission float
)

create table Orders_(
ord_no int,
purch_amt float,
ord_date varchar(100),
customer_id varchar(100),
salesman_id int
)

create table Customer(
customer_id int,
cust_name varchar(100),
city varchar(100),
grade int,
salesman_id int
)


insert into Salesman(salesman_id,name,city,commission) values(5001,'James Hoog','New York',0.15);
insert into Salesman(salesman_id,name,city,commission) values(5002,'Nail Knite','Paris',0.13);
insert into Salesman(salesman_id,name,city,commission) values(5003,'Pit Alex','London',0.11);
insert into Salesman(salesman_id,name,city,commission) values(5004,'Mc Lyon','Paris',0.14);
insert into Salesman(salesman_id,name,city,commission) values(5005,'Lauson Hen','tangalle',0.12);
insert into Salesman(salesman_id,name,city,commission) values(5006,'Paul Adam','Rome',0.13);
insert into Salesman(salesman_id,name,city,commission) values(5007,'abeywickrama','jafna',0.15); 
insert into Salesman(salesman_id,name,city,commission) values(5008,'kavishka','nalagama',0.35); 


insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70001,150.5,'2012-10-05','3005',5002);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70009,270.65,'2012-09-10','3001',5005);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70002,65.26,'2012-10-05','3002',5001);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70004,110.5,'2012-08-17','3009',5003);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70007,948.5,'2012-09-10','3005',5002);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70005,2400.6,'2012-07-27','3007',5001);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70008,5760,'2012-09-10','3002',5001);           
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70010,1983.43,'2012-10-10','3004',5006); 
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70003,2480.4,'2012-10-10','3009',5003);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70012,250.45,'2012-06-27','3008',5002);
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70011,75.29,'2012-08-17','3003',5007); 
insert into Orders_(ord_no,purch_amt,ord_date,customer_id,salesman_id) values(70013,3045.6,'2012-04-25','3002',5001); 




insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3002,'Nick Rimando','New York',100,5001);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3007,'Brad Davis','New York',200,5001);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3005,'Graham Zusi','California',200,5002);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3008,'Julian Green','London',300,5002);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3004,'Fabian Johnson','Paris',300,5006);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3009,'Geoff Cameron','Berlin',100,5003);
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3003,'Jozy Altidor','Moscow',200,5007);           
insert into Customer(customer_id,cust_name,city,grade,salesman_id) values(3001,'Brad Guzan','London',0 ,5005); 







select * from Salesman

select * from Orders_

select * from Customer


---1. From the following tables, write a SQL query to find all the orders issued by the salesman 'Paul Adam'. 
---Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

-- answer 01
select o.ord_no, o.purch_amt, o.ord_date, o.customer_id, o.salesman_id
from Salesman s, Orders_ o
where s.name = 'Paul Adam' AND s.salesman_id = o.salesman_id


-- answer 02
SELECT *
FROM orders_
WHERE salesman_id =
    (SELECT salesman_id 
     FROM salesman 
     WHERE name='Paul Adam');


---2. From the following tables write a SQL query to find all orders generated by London-based salespeople. 
---Return ord_no, purch_amt, ord_date, customer_id, salesman_id.


select *
from Orders_ 
where salesman_id IN
	(select salesman_id
	from Salesman
	where city = 'London');


---3. From the following tables write a SQL query to find all orders generated by the salespeople who may work for customers whose id is 3007. 
---Return ord_no, purch_amt, ord_date, customer_id, salesman_id.


select *
from Orders_
where salesman_id IN
		(select DISTINCT salesman_id
		from Orders_
		where customer_id = '3007')


---4. From the following tables write a SQL query to find the order values greater than the average order value of 10th October 2012. 
---Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

select *
from Orders_
where purch_amt >  
	(select avg(purch_amt)
	from Orders_
	where ord_date = '2012-10-10');

---5. From the following tables, write a SQL query to find all the orders generated in New York city. 
---Return ord_no, purch_amt, ord_date, customer_id and salesman_id. 


select *
from Orders_
where salesman_id = (
					select salesman_id
					from Salesman
					where city = 'New York')

---6. From the following tables write a SQL query to determine the commission of the salespeople in Paris. 
---Return commission.
select commission
from Salesman
where salesman_id IN
		(select salesman_id
		from Salesman
		where city='Paris') 


---7. Write a query to display all the customers whose ID is 2001 below the salesperson ID of Mc Lyon.

select *
from Customer
where customer_id = (select salesman_id - 2001
					from Salesman
					where name='Mc Lyon')


---8. From the following tables write a SQL query to count the number of customers with grades above the average in New York City. 
---Return grade and count.  












